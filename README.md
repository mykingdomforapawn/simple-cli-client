# Simple CLI Client

A simple CLI project for consuming a REST API using an auto-generated client library.

> **AI Disclaimer:** This project was developed with the assistance of Google's Gemini to guide the learning process, explain concepts, and generate code.

---

## Purpose

This project is a companion to the [`api-for-dummies`](https://github.com/mykingdomforapawn/api-for-dummies) server. Its purpose is to explore the concepts of consuming a REST API using a client library that is automatically generated from an OpenAPI specification. It demonstrates how a "client" application can be completely decoupled from a "server," communicating only through a shared API contract, and how this process can be automated.

---

## Features

* **Technology**: A Command-Line Interface (CLI) built with Python and **Typer**.
* **API Client**: The client library used to communicate with the API is automatically generated by **OpenAPI Generator** based on the server's specification.
* **Automation**: Includes a GitHub Actions workflow that:
    * Fetches the latest `openapi.json` spec from the `api-for-dummies` repository releases.
    * Regenerates the client library.
    * Applies automated patches for known generator bugs.
    * Opens a pull request with the updated client code.
* **Commands (Full CRUD)**:
    * `list`: Fetches and displays all documents.
    * `create`: Creates a new document via command-line options.
    * `delete`: Deletes a document by its ID.

---

## Setup and Usage

To run this client, you need a running instance of the `api-for-dummies` API server (at `http://127.0.0.1:8000`).

1.  **Clone the repository and navigate into the directory.**

2.  **Create and activate a Python virtual environment:**
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows use `venv\Scripts\activate`
    ```

3.  **Install dependencies:**
    This installs Typer and the dependencies required by the auto-generated client library.
    ```bash
    pip install "typer[all]"
    pip install -r generated_client/requirements.txt
    ```

4.  **Run the CLI:**
    Make sure your API server is running, then execute commands:

    * **See available commands:**
        ```bash
        python client.py --help
        ```
    * **List documents:**
        ```bash
        python client.py list
        ```
    * **Create a document:**
        ```bash
        python client.py create --name "My Report" --owner "Admin" --type PDF
        ```
    * **Delete a document (e.g., ID 1):**
        ```bash
        python client.py delete 1
        ```

---

## Automation: Keeping the Client Up-to-Date

This repository includes a GitHub Actions workflow (`.github/workflows/regenerate-client.yml`) that automates the process of updating the client library when the API server's specification changes.

* **Trigger:** Can be run manually from the "Actions" tab on GitHub.
* **Process:** Downloads the latest `openapi.json` from the `api-for-dummies` releases, regenerates the code in `generated_client/`, applies necessary patches, and creates a pull request.
* **Maintenance:** Merging the automated pull request updates the client library in this repository.

---

## Learning Roadmap

This project has explored the following concepts:

* [x] **Code Generation**: Generated a Python client from an `openapi.json` specification file.
* [x] **API Consumption**: Used the auto-generated client to interact with a live API.
* [x] **CLI Implementation**: Built a user-friendly CLI application using Typer.
* [x] **Inter-Repository Automation**: Created a GitHub Actions workflow that automatically regenerates the client via pull request when the upstream API spec changes.